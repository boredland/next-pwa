{"version":3,"sources":["../src/register.js"],"names":["Workbox","has","c","isUpdate","cache","response","_response","data","n","d","cacheOnFrontEndNav","url","res","pushState","replaceState"],"mappings":"AAAA,OAAS,WAAAA,MAAe,iBAExB,GACE,OAAO,QAAW,aAClB,kBAAmB,WACnB,OAAO,QAAW,YAClB,CAqDA,GApDI,mBACF,OAAO,IAAI,WAAW,EAAE,KAAK,SAAUC,EAAK,CACrCA,GACH,OACG,KAAK,WAAW,EAChB,KAAMC,GACLA,EAAE,IAAI,kBAAmB,IAAI,SAAS,GAAI,CAAE,OAAQ,GAAI,CAAC,CAAC,CAC5D,CAEN,CAAC,EAGH,OAAO,QAAU,IAAIF,EAAQ,OAAO,SAAS,OAAS,WAAY,CAChE,MAAO,aACT,CAAC,EAEG,mBACF,OAAO,QAAQ,iBAAiB,YAAa,MAAO,CAAE,SAAAG,CAAS,IAAM,CACnE,GAAI,CAACA,EAAU,CACb,IAAMC,EAAQ,MAAM,OAAO,KAAK,WAAW,EACrCC,EAAW,MAAM,MAAM,iBAAiB,EAC1CC,EAAYD,EACZA,EAAS,aACXC,EAAY,IAAI,SAASD,EAAS,KAAM,CACtC,OAAQ,IACR,WAAY,KACZ,QAASA,EAAS,OACpB,CAAC,GAGH,MAAMD,EAAM,IAAI,kBAAmBE,CAAS,EAEhD,CAAC,EAGH,OAAO,QAAQ,iBAAiB,YAAa,SAAY,CACvD,IAAMC,EAAO,OAAO,YACjB,iBAAiB,UAAU,EAC3B,IAAK,GAAM,EAAE,IAAI,EACjB,OACEC,GACCA,EAAE,WAAW,GAAG,OAAO,SAAS,oBAAoB,GACpDA,EAAE,SAAS,OAAO,CACtB,EACIJ,EAAQ,MAAM,OAAO,KAAK,WAAW,EAC3CG,EAAK,QAASE,GAAML,EAAM,IAAIK,CAAC,CAAC,CAClC,CAAC,EAEG,yBACF,OAAO,QAAQ,SAAS,EAGtB,gCAAkC,kBAAmB,CACvD,IAAMC,EAAqB,SAAUC,EAAK,CACxC,GAAK,OAAO,UAAU,OACtB,IAAI,gCAAkCA,IAAQ,kBAC5C,OAAO,OAAO,KAAK,QAAQ,EAAE,KAAMP,GACjCA,EAAM,MAAMO,EAAK,CAAE,aAAc,EAAK,CAAC,EAAE,KAAMC,GACxCA,EACE,QAAQ,QAAQ,EADNR,EAAM,IAAIO,CAAG,CAE/B,CACH,EACK,GAAI,mBAAqBA,IAAQ,kBACtC,OAAO,MAAM,iBAAiB,EAAE,KAAK,SAAUN,EAAU,CACvD,OAAKA,EAAS,WAKP,QAAQ,QAAQ,EAJd,OACJ,KAAK,WAAW,EAChB,KAAMD,GAAUA,EAAM,IAAI,kBAAmBC,CAAQ,CAAC,CAG7D,CAAC,EAEL,EAEMQ,EAAY,QAAQ,UAC1B,QAAQ,UAAY,UAAY,CAC9BA,EAAU,MAAM,QAAS,SAAS,EAClCH,EAAmB,UAAU,CAAC,CAAC,CACjC,EAEA,IAAMI,EAAe,QAAQ,aAC7B,QAAQ,aAAe,UAAY,CACjCA,EAAa,MAAM,QAAS,SAAS,EACrCJ,EAAmB,UAAU,CAAC,CAAC,CACjC,EAEA,OAAO,iBAAiB,SAAU,IAAM,CACtCA,EAAmB,OAAO,SAAS,QAAQ,CAC7C,CAAC,EAGC,0BACF,OAAO,iBAAiB,SAAU,IAAM,CACtC,SAAS,OAAO,CAClB,CAAC","sourcesContent":["import { Workbox } from \"workbox-window\";\n\nif (\n  typeof window !== \"undefined\" &&\n  \"serviceWorker\" in navigator &&\n  typeof caches !== \"undefined\"\n) {\n  if (__PWA_START_URL__) {\n    caches.has(\"start-url\").then(function (has) {\n      if (!has) {\n        caches\n          .open(\"start-url\")\n          .then((c) =>\n            c.put(__PWA_START_URL__, new Response(\"\", { status: 200 }))\n          );\n      }\n    });\n  }\n\n  window.workbox = new Workbox(window.location.origin + __PWA_SW__, {\n    scope: __PWA_SCOPE__,\n  });\n\n  if (__PWA_START_URL__) {\n    window.workbox.addEventListener(\"installed\", async ({ isUpdate }) => {\n      if (!isUpdate) {\n        const cache = await caches.open(\"start-url\");\n        const response = await fetch(__PWA_START_URL__);\n        let _response = response;\n        if (response.redirected) {\n          _response = new Response(response.body, {\n            status: 200,\n            statusText: \"OK\",\n            headers: response.headers,\n          });\n        }\n\n        await cache.put(__PWA_START_URL__, _response);\n      }\n    });\n  }\n\n  window.workbox.addEventListener(\"installed\", async () => {\n    const data = window.performance\n      .getEntriesByType(\"resource\")\n      .map((e) => e.name)\n      .filter(\n        (n) =>\n          n.startsWith(`${window.location.origin}/_next/data/`) &&\n          n.endsWith(\".json\")\n      );\n    const cache = await caches.open(\"next-data\");\n    data.forEach((d) => cache.add(d));\n  });\n\n  if (__PWA_ENABLE_REGISTER__) {\n    window.workbox.register();\n  }\n\n  if (__PWA_CACHE_ON_FRONT_END_NAV__ || __PWA_START_URL__) {\n    const cacheOnFrontEndNav = function (url) {\n      if (!window.navigator.onLine) return;\n      if (__PWA_CACHE_ON_FRONT_END_NAV__ && url !== __PWA_START_URL__) {\n        return caches.open(\"others\").then((cache) =>\n          cache.match(url, { ignoreSearch: true }).then((res) => {\n            if (!res) return cache.add(url);\n            return Promise.resolve();\n          })\n        );\n      } else if (__PWA_START_URL__ && url === __PWA_START_URL__) {\n        return fetch(__PWA_START_URL__).then(function (response) {\n          if (!response.redirected) {\n            return caches\n              .open(\"start-url\")\n              .then((cache) => cache.put(__PWA_START_URL__, response));\n          }\n          return Promise.resolve();\n        });\n      }\n    };\n\n    const pushState = history.pushState;\n    history.pushState = function () {\n      pushState.apply(history, arguments);\n      cacheOnFrontEndNav(arguments[2]);\n    };\n\n    const replaceState = history.replaceState;\n    history.replaceState = function () {\n      replaceState.apply(history, arguments);\n      cacheOnFrontEndNav(arguments[2]);\n    };\n\n    window.addEventListener(\"online\", () => {\n      cacheOnFrontEndNav(window.location.pathname);\n    });\n  }\n\n  if (__PWA_RELOAD_ON_ONLINE__) {\n    window.addEventListener(\"online\", () => {\n      location.reload();\n    });\n  }\n}\n"]}